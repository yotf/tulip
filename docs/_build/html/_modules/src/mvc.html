<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>src.mvc &mdash; src  documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="src  documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">src  documentation</a> &raquo;</li>
          <li><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for src.mvc</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">.. module:: mvc</span>
<span class="sd">   :platform: Unix, Windows</span>
<span class="sd">   :synopsis:  MVC of the appliaction</span>

<span class="sd">.. moduleauthor:: Tara Petric &lt;tara.petric@gmail.com&gt;</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">wx</span>
<span class="kn">import</span> <span class="nn">mvc_skelet</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">join</span>
<span class="kn">import</span> <span class="nn">util</span>
<span class="kn">import</span> <span class="nn">unify</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">profile</span> <span class="kn">import</span> <span class="o">*</span>

<div class="viewcode-block" id="Choices"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices">[docs]</a><span class="k">class</span> <span class="nc">Choices</span><span class="p">(</span><span class="n">mvc_skelet</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">base_regex</span> <span class="o">=</span> <span class="s">r&#39;^L\d+T\d+(?P&lt;therm&gt;THERM\d+)&#39;</span>
    <span class="n">single_base</span> <span class="o">=</span> <span class="s">r&#39;</span><span class="si">%s</span><span class="s">MC\d+.*&#39;</span> <span class="o">%</span> <span class="n">base_regex</span>
    <span class="n">sp_regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&#39;</span><span class="si">%s</span><span class="s">\.sp$&#39;</span> <span class="o">%</span> <span class="n">single_base</span><span class="p">)</span>
    <span class="n">mp_regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&#39;</span><span class="si">%s</span><span class="s">(\.all|MC\d+.*\.mp|MC\d+.*\.dat)$&#39;</span> <span class="o">%</span> <span class="n">base_regex</span><span class="p">)</span>
    <span class="n">all_regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&#39;</span><span class="si">%s</span><span class="s">\.all$&#39;</span> <span class="o">%</span><span class="n">base_regex</span><span class="p">)</span>
    <span class="n">lt_regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&#39;(L\d+)(T\d+)$&#39;</span><span class="p">)</span>
    <span class="n">statmc_regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&#39;^MC\d+$&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the logger</span>
<span class="sd">        and sets all the dictionaries used to None</span>
<span class="sd">        for clarity</span>
<span class="sd">        : returns : Nothing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mvc_skelet</span><span class="o">.</span><span class="n">Model</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s">&quot;Choices&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bestmats</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mags</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">files</span> <span class="o">=</span> <span class="bp">None</span>

        
<div class="viewcode-block" id="Choices.init_model"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.init_model">[docs]</a>    <span class="k">def</span> <span class="nf">init_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initializes the model</span>
<span class="sd">        Runs when GUI is up</span>
<span class="sd">        Maps the current filesystem</span>

<span class="sd">         Sets the quantaties of interest that can be plotted:</span>
<span class="sd">        * susc</span>
<span class="sd">        * Tcap</span>
<span class="sd">        * M1avg</span>
<span class="sd">        * M2avg</span>
<span class="sd">        * M4avg</span>
<span class="sd">        * Eavg</span>
<span class="sd">        * E2avg</span>
<span class="sd">        * U</span>
<span class="sd">        </span>
<span class="sd">        : returns : Nothing</span>
<span class="sd">        </span>
<span class="sd">        : raises BaseException: if there was an exception \</span>
<span class="sd">        when mapping the filesystem, it is propagated to the app \</span>
<span class="sd">        and it exits with code 0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_map_filesystem</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">e</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_state</span><span class="p">()</span>
        <span class="c"># TODO : custom formulae?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mags</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s">&#39;susc&#39;</span><span class="p">,</span>
        <span class="s">&#39;Tcap&#39;</span><span class="p">,</span>
        <span class="s">&#39;M1avg&#39;</span><span class="p">,</span>
        <span class="s">&#39;M2avg&#39;</span><span class="p">,</span>
        <span class="s">&#39;M4avg&#39;</span><span class="p">,</span>
        <span class="s">&#39;Eavg&#39;</span><span class="p">,</span>
        <span class="s">&#39;E2avg&#39;</span><span class="p">,</span>
        <span class="s">&#39;U&#39;</span>        
        <span class="p">]</span>

</div>
<div class="viewcode-block" id="Choices.add_virtual_file"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.add_virtual_file">[docs]</a>    <span class="k">def</span> <span class="nf">add_virtual_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">mc</span><span class="p">,</span><span class="n">therm</span><span class="p">,</span><span class="n">booli</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculates the mat file for the given parameters</span>
<span class="sd">        Updates the direcotry structure to show the new</span>
<span class="sd">        number of SPs and the appropriate number of LSs</span>

<span class="sd">        Notifies observers of change in model</span>
<span class="sd">        </span>
<span class="sd">        :param dir_: The simulation directory.</span>
<span class="sd">        :param l: The linear lattice size.</span>
<span class="sd">        :type l: str.</span>
<span class="sd">        :type dir_: str.</span>
<span class="sd">        :param t: The given temperature.</span>
<span class="sd">        :type t: str.</span>
<span class="sd">        :param mc: The number of Simulation Paths.</span>
<span class="sd">        :type mc: str.</span>
<span class="sd">        :param therm: The number of Lattice Sweeps.</span>
<span class="sd">        :type therm: str.</span>
<span class="sd">        :param booli: When &#39;cutting&#39; bad results.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_mat</span><span class="p">(</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">therm</span><span class="p">,</span><span class="n">booli</span><span class="o">=</span><span class="n">booli</span><span class="p">)</span>
        <span class="n">therm_ch</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">therm_ch</span><span class="p">[</span><span class="n">therm</span><span class="p">]</span><span class="o">=</span><span class="n">mat</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="n">dir_</span><span class="p">][</span><span class="n">l</span><span class="p">][</span><span class="n">t</span><span class="p">][</span><span class="n">mc</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">therm_ch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notify_observers</span><span class="p">()</span>
        </div>
<div class="viewcode-block" id="Choices.add_bestmat"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.add_bestmat">[docs]</a>    <span class="k">def</span> <span class="nf">add_bestmat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">mc</span><span class="p">,</span><span class="n">therm</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a file as the best choice</span>
<span class="sd">        to be used for later plotting.</span>
<span class="sd">        **Notifies** *observers*.</span>
<span class="sd">        </span>
<span class="sd">        :param dir_: The simulation directory.</span>
<span class="sd">        :param l: The linear lattice size.</span>
<span class="sd">        :type l: str.</span>
<span class="sd">        :type dir_: str.</span>
<span class="sd">        :param t: The given temperature.</span>
<span class="sd">        :type t: str.</span>
<span class="sd">        :param mc: The number of Simulation Paths.</span>
<span class="sd">        :type mc: str.</span>
<span class="sd">        :param therm: The number of Lattice Sweeps.</span>
<span class="sd">        :type therm: str.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">bestmats</span><span class="p">[</span><span class="n">dir_</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bestmats</span><span class="p">[</span><span class="n">dir_</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bestmats</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">dir_</span><span class="p">)</span> <span class="k">else</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bestmats</span><span class="p">[</span><span class="n">dir_</span><span class="p">][</span><span class="n">l</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bestmats</span><span class="p">[</span><span class="n">dir_</span><span class="p">][</span><span class="n">l</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bestmats</span><span class="p">[</span><span class="n">dir_</span><span class="p">]</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="k">else</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bestmats</span><span class="p">[</span><span class="n">dir_</span><span class="p">][</span><span class="n">l</span><span class="p">][</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;mc&#39;</span><span class="p">:</span><span class="n">mc</span><span class="p">,</span><span class="s">&#39;therm&#39;</span><span class="p">:</span><span class="n">therm</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_mats</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notify_observers</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Choices.random_bestmats"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.random_bestmats">[docs]</a>    <span class="k">def</span> <span class="nf">random_bestmats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        
        <span class="sd">&quot;&quot;&quot;prosledjuje mu se direktorijum za koji da izabere</span>
<span class="sd">        sve random bestmatove&quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">random</span>
       
        <span class="k">try</span><span class="p">:</span>
            <span class="n">l</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;l&#39;</span><span class="p">]</span>
            <span class="c">#zbog mogucnosti prosledjivanja None</span>
            <span class="k">for</span> <span class="n">t</span><span class="p">,</span><span class="n">mcdict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="n">dir_</span><span class="p">][</span><span class="n">l</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="c">#mc= random.sample(mcdict.keys(),1)[0]</span>
                <span class="n">mc</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">mcdict</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">util</span><span class="o">.</span><span class="n">extract_int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
                <span class="k">print</span> <span class="nb">type</span><span class="p">(</span><span class="n">mc</span><span class="p">),</span><span class="n">mc</span>
                <span class="c">#therm = random.sample(mcdict[mc].keys(),1)[0]</span>
                <span class="n">therm</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">mcdict</span><span class="p">[</span><span class="n">mc</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">util</span><span class="o">.</span><span class="n">extract_int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
                <span class="k">print</span> <span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">mc</span><span class="p">,</span><span class="n">therm</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_bestmat</span><span class="p">(</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">mc</span><span class="p">,</span><span class="n">therm</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="n">util</span><span class="o">.</span><span class="n">show_error</span><span class="p">(</span><span class="s">&#39;No Lattice Size selected&#39;</span><span class="p">,</span><span class="s">&#39;Contact developer to disable Random button&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">util</span><span class="o">.</span><span class="n">show_error</span><span class="p">(</span><span class="s">&quot;Don&#39;t know&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
            <span class="k">raise</span> <span class="n">e</span>
</div>
<div class="viewcode-block" id="Choices.save_mats"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.save_mats">[docs]</a>    <span class="k">def</span> <span class="nf">save_mats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
        <span class="n">for_save</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bestmats</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">dir_</span><span class="p">,</span><span class="n">ldict</span> <span class="ow">in</span> <span class="n">for_save</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">l</span><span class="p">,</span><span class="n">tdict</span> <span class="ow">in</span> <span class="n">ldict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">t</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="n">tdict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="s">&#39;[&#39;</span> <span class="ow">in</span> <span class="n">val</span><span class="p">[</span><span class="s">&#39;mc&#39;</span><span class="p">]:</span>
                        <span class="k">del</span> <span class="n">tdict</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;for save:</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span><span class="n">for_save</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;bestmat:</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">bestmats</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simdir</span><span class="p">,</span><span class="s">&#39;bestmat.dict&#39;</span><span class="p">),</span><span class="s">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">bmatfile</span><span class="p">:</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">for_save</span><span class="p">),</span><span class="n">bmatfile</span><span class="p">)</span>
            </div>
    <span class="nd">@logg</span>
<div class="viewcode-block" id="Choices.remove_bestmat"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.remove_bestmat">[docs]</a>    <span class="k">def</span> <span class="nf">remove_bestmat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;U slucaju da je na l</span>
<span class="sd">        kliknuto, svi za taj l se brisu</span>
<span class="sd">        i suprotnom samo odrejeni. Jako je</span>
<span class="sd">        tight coupling izmedju ovih zbog ovog</span>
<span class="sd">        kwargs. Mozda bude pravilo problema&quot;&quot;&quot;</span>
        <span class="n">dir_</span><span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;dir_&#39;</span><span class="p">]</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;l&#39;</span><span class="p">]</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">bestmats</span><span class="p">[</span><span class="n">dir_</span><span class="p">][</span><span class="n">l</span><span class="p">][</span><span class="n">t</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">bestmats</span><span class="p">[</span><span class="n">dir_</span><span class="p">][</span><span class="n">l</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Sad je prazno za taj l, brisem ga celog&#39;</span><span class="p">)</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">bestmats</span><span class="p">[</span><span class="n">dir_</span><span class="p">][</span><span class="n">l</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Brisem iz bestmata za l:{} i t:{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bestmats</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Brisem iz bestmata za l:{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Sada bestmat izgleda ovako: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bestmats</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Kliknuo korisnik na ne bestmat stvar. Idiot!&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">clean_bmat</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_mats</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notify_observers</span><span class="p">()</span>
            
        </div>
<div class="viewcode-block" id="Choices.add_mc"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.add_mc">[docs]</a>    <span class="k">def</span> <span class="nf">add_mc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mc</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Prima za koje l t da generise novo</span>
<span class="sd">        mc, i stavlja ga u sturkturu podataka</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">statmc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_static_mcs</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;mc&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">statmc</span>
        <span class="n">therms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">tdict</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span><span class="bp">None</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">therms</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;adding mc </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">tdict</span> <span class="p">)</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;mc&#39;</span><span class="p">]</span><span class="o">=</span><span class="s">&quot;MC</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">mc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_to_map</span><span class="p">(</span><span class="n">tdict</span> <span class="o">=</span> <span class="n">tdict</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Choices.add_to_map"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.add_to_map">[docs]</a>    <span class="k">def</span> <span class="nf">add_to_map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">mc</span><span class="p">,</span><span class="n">tdict</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="n">dir_</span><span class="p">][</span><span class="n">l</span><span class="p">][</span><span class="n">t</span><span class="p">][</span><span class="n">mc</span><span class="p">]</span><span class="o">=</span><span class="n">tdict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notify_observers</span><span class="p">()</span>
        </div>
<div class="viewcode-block" id="Choices.get_maxmc"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.get_maxmc">[docs]</a>    <span class="k">def</span> <span class="nf">get_maxmc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Vraca makisamalan BROJ</span>
<span class="sd">        mc-ova&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Vracam max mc&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">util</span><span class="o">.</span><span class="n">extract_int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">),</span><span class="n">key</span> <span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">util</span><span class="o">.</span><span class="n">extract_int</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        </div>
<div class="viewcode-block" id="Choices.get_mags"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.get_mags">[docs]</a>    <span class="k">def</span> <span class="nf">get_mags</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Taj mags ce sadrzati i formule</span>
<span class="sd">        a i mozda ove stringove koji korespondiraju.</span>
<span class="sd">        Videcemo. Samo Nek ti proradi ovo i onda malo</span>
<span class="sd">        doteruj&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mags</span>
</div>
    <span class="nd">@logg</span>
<div class="viewcode-block" id="Choices.choices"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.choices">[docs]</a>    <span class="k">def</span> <span class="nf">choices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">l</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">mc</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Nemoj da prosledjujes van redosleda argumenta</span>
<span class="sd">        tj, nemoj da si prosledila therm ako nemas</span>
<span class="sd">        mc!&quot;&quot;&quot;</span>
        <span class="n">ls</span> <span class="o">=</span> <span class="p">[</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">mc</span><span class="p">]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span>
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">ls</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">val</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">val</span><span class="p">]</span>
        <span class="c">#self.log.debug(&quot;Vracam izbore :{} za l:{} t:{} mc:{} &quot;.format(x,l,t,mc))</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Choices.bestmat_choices"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.bestmat_choices">[docs]</a>    <span class="k">def</span> <span class="nf">bestmat_choices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">l</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">which</span><span class="o">=</span><span class="s">&#39;mc&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ocekuje dobar format. ne znam kako to da omogucim</span>
<span class="sd">        uvek. sta bi ovaj rekao. oni treba da komuniciraju</span>
<span class="sd">        i dogovore format. hmh. mi kazemo sta hocemo a oni</span>
<span class="sd">        izkomuniciraju</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">ls</span> <span class="o">=</span> <span class="p">[</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">which</span><span class="p">]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bestmats</span>
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">ls</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">val</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">val</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Vracam bestmat izbore :{} za l:{} t:{} mctherm:{} &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">which</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;type od povratne vrednosti je {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">basestring</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span>
        
        </div>
<div class="viewcode-block" id="Choices.get_static_mcs"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.get_static_mcs">[docs]</a>    <span class="k">def</span> <span class="nf">get_static_mcs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Vraca samo one mc-ove koji se nalaze</span>
<span class="sd">        na disku. ili imaju isti format kao ti na disku</span>
<span class="sd">        jbg</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">statmcs</span> <span class="o">=</span> <span class="p">[</span> <span class="n">mc</span> <span class="k">for</span> <span class="n">mc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">statmc_regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">mc</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Vracam staticke mc-ove:{} za dir:{dir_} l:{l} t:{t}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">statmcs</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">statmcs</span>
        </div>
<div class="viewcode-block" id="Choices.load_state"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.load_state">[docs]</a>    <span class="k">def</span> <span class="nf">load_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Postavlja tulip u stanje u kom</span>
<span class="sd">        ga je korisnik ostavio. Sto se tice</span>
<span class="sd">        izbora samo, doduse&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_bestmat</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Choices.clean_bmat"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.clean_bmat">[docs]</a>    <span class="k">def</span> <span class="nf">clean_bmat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Brise prazne vrednosti iz bestmata&quot;&quot;&quot;</span>
        
        <span class="k">for</span> <span class="n">dir_</span><span class="p">,</span><span class="n">ldict</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bestmats</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ldict</span><span class="p">:</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">bestmats</span><span class="p">[</span><span class="n">dir_</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">l</span><span class="p">,</span><span class="n">tdict</span> <span class="ow">in</span> <span class="n">ldict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">tdict</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">ldict</span><span class="p">[</span><span class="n">l</span><span class="p">]</span>
                    <span class="k">continue</span>
                <span class="k">for</span> <span class="n">t</span><span class="p">,</span><span class="n">tmc_dict</span> <span class="ow">in</span> <span class="n">tdict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">tmc_dict</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">tdict</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
                        <span class="k">continue</span>
                        
        
</div>
<div class="viewcode-block" id="Choices.load_choices"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.load_choices">[docs]</a>    <span class="k">def</span> <span class="nf">load_choices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fname</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Loading {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fname</span><span class="p">))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simdir</span><span class="p">,</span><span class="n">fname</span><span class="p">),</span><span class="n">mode</span><span class="o">=</span><span class="s">&quot;ab+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">hashf</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fcontent</span> <span class="o">=</span>  <span class="nb">dict</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">hashf</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">EOFError</span><span class="p">:</span>
                <span class="n">fcontent</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">fcontent</span>
</div>
<div class="viewcode-block" id="Choices.load_sp_data"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.load_sp_data">[docs]</a>    <span class="k">def</span> <span class="nf">load_sp_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Ucitava podatke za isrcatavanje na</span>
<span class="sd">        scatter panelu, i vraca u formatu pogodnom</span>
<span class="sd">        za plotovanje&quot;&quot;&quot;</span>
        <span class="n">all_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">bestmats</span><span class="p">[</span><span class="n">dir_</span><span class="p">][</span><span class="n">l</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">t</span><span class="p">,</span><span class="n">tmc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bestmats</span><span class="p">[</span><span class="n">dir_</span><span class="p">][</span><span class="n">l</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">simdir</span><span class="p">,</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">tmc</span><span class="p">[</span><span class="s">&#39;therm&#39;</span><span class="p">]</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_filename</span><span class="p">(</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">tmc</span><span class="p">[</span><span class="s">&#39;therm&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Loading data from file </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>
            <span class="c"># ne znam da li mi treba ovde neki try catch hmhmhmhmhmhmhmmhhh</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_tdfile</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;rows read: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">data</span><span class="o">.</span><span class="n">E</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
            <span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">E</span><span class="o">.</span><span class="n">count</span><span class="p">()),</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">all_data</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">all_data</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span>
            
        </div>
<div class="viewcode-block" id="Choices.unify"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.unify">[docs]</a>    <span class="k">def</span> <span class="nf">unify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">lt_dir</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">unify</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">lt_dir</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span> <span class="p">:</span>
            <span class="n">util</span><span class="o">.</span><span class="n">show_error</span><span class="p">(</span><span class="s">&quot;Duplicate Seeds&quot;</span><span class="p">,</span><span class="s">&quot;Duplicated seeds found while unifying! What to do, what to do????!?!?!&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Choices.spify"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.spify">[docs]</a>    <span class="k">def</span> <span class="nf">spify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">lt_dir</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Proverava da nema dva fajla sa istim thermovima</span>
<span class="sd">        i razlicitim mc-ovima. Blahhhhhh&quot;&quot;&quot;</span>
        <span class="k">print</span> <span class="s">&#39;spifyinggg&#39;</span>
        <span class="n">ls</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_regex</span><span class="p">,</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">groupdict</span><span class="p">()[</span><span class="s">&#39;therm&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">lt_dir</span><span class="p">)</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_regex</span><span class="p">,</span><span class="n">f</span><span class="p">)]</span>
        <span class="k">print</span> <span class="n">ls</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span><span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ls</span><span class="p">)):</span>
            <span class="n">util</span><span class="o">.</span><span class="n">show_error</span><span class="p">(</span><span class="s">&#39;Single path error&#39;</span><span class="p">,</span><span class="s">&#39;Two files with same therm different mcs in </span><span class="si">%s</span><span class="s">. Please delete one. Exiting now&#39;</span> <span class="o">%</span><span class="n">lt_dir</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s">&quot;nautilus </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">lt_dir</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">raise</span> <span class="ne">BaseException</span>
        
        </div>
<div class="viewcode-block" id="Choices.therm_count"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.therm_count">[docs]</a>    <span class="k">def</span> <span class="nf">therm_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">mc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Vraca koliko ima tacaka za dato mc, tj.trebace kod</span>
<span class="sd">        ovog therm panela da vidi neko da ne plotuje nebulozne</span>
<span class="sd">        stvari. znaci ovo ce biti u nekim viticastim zagradama</span>
<span class="sd">        iza broja mc-ova&quot;&quot;&quot;</span>
        <span class="n">therms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">mc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Vracam broj thermova:{} za mc:{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">therms</span><span class="p">),</span><span class="n">mc</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">therms</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Choices.name_gen"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.name_gen">[docs]</a>    <span class="k">def</span> <span class="nf">name_gen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">cntr</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">constants</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;seed&#39;</span><span class="p">,</span><span class="s">&#39;E&#39;</span><span class="p">]</span>
        <span class="k">while</span><span class="p">(</span><span class="bp">True</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">cntr</span><span class="o">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">constants</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">yield</span> <span class="s">&#39;M</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cntr</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">constants</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">constants</span><span class="p">[</span><span class="n">cntr</span><span class="p">]</span>
            <span class="n">cntr</span><span class="o">=</span><span class="n">cntr</span><span class="o">+</span><span class="mi">1</span>
</div>
<div class="viewcode-block" id="Choices.read_tdfile"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.read_tdfile">[docs]</a>    <span class="k">def</span> <span class="nf">read_tdfile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="p">,</span><span class="n">first_mcs</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="n">nrows</span><span class="o">=</span><span class="n">first_mcs</span><span class="p">,</span><span class="n">delim_whitespace</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;len of columns </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
        <span class="k">print</span> <span class="n">data</span>
        <span class="n">ngen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_gen</span><span class="p">()</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">ngen</span><span class="o">.</span><span class="n">next</span><span class="p">()</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
        <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">names</span>
        <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;seed&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span>
</div>
<div class="viewcode-block" id="Choices.mag_components"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.mag_components">[docs]</a>    <span class="k">def</span> <span class="nf">mag_components</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;izvlaci kolone koje sadrze</span>
<span class="sd">        komponente magnetizacije i vraca</span>
<span class="sd">        ih u novoj tabeli&quot;&quot;&quot;</span>
        <span class="n">ix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mag_index</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">MAG</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">MAG</span>
</div>
<div class="viewcode-block" id="Choices.mag_index"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.mag_index">[docs]</a>    <span class="k">def</span> <span class="nf">mag_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
        <span class="n">ix</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;M&#39;</span><span class="p">):</span>
                <span class="n">ix</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ix</span>
</div>
<div class="viewcode-block" id="Choices.calculate_magt"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.calculate_magt">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_magt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;za datafrejm koji se sastoji</span>
<span class="sd">        od nekoliko kolona gde su neke od njih</span>
<span class="sd">        magnetne komponente, i pocinju sa M, on racuna</span>
<span class="sd">        intenzitet&quot;&quot;&quot;</span>
        <span class="n">mag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mag_components</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">mag2</span> <span class="o">=</span> <span class="n">mag</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="c"># Mx^2 + My^2 + Mz^2 ...</span>
        <span class="n">magt</span> <span class="o">=</span> <span class="n">mag2</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="c"># koren iz toga, intenzitet</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">magt</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Choices.get_filename"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.get_filename">[docs]</a>    <span class="k">def</span> <span class="nf">get_filename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">therm</span><span class="p">):</span>
        <span class="n">regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&#39;(^</span><span class="si">%s%s%s</span><span class="s">(MC.*\.sp|\.all))&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">therm</span><span class="p">))</span>
        <span class="n">filenames</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simdir</span><span class="p">,</span><span class="n">dir_</span><span class="p">,</span><span class="s">&#39;</span><span class="si">%s%s</span><span class="s">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">)))</span> <span class="k">if</span> <span class="n">regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">f</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span><span class="o">!=</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">util</span><span class="o">.</span><span class="n">show_error</span><span class="p">(</span><span class="s">&#39;Emergency&#39;</span><span class="p">,</span><span class="s">&#39;Report issue asap with code 1100010001110**__??&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">BaseException</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simdir</span><span class="p">,</span><span class="n">dir_</span><span class="p">,</span><span class="s">&#39;</span><span class="si">%s%s</span><span class="s">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">),</span><span class="n">filename</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Choices.create_mat"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.create_mat">[docs]</a>    <span class="k">def</span> <span class="nf">create_mat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">therm</span><span class="p">,</span><span class="n">mc</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">booli</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Cita all fajlove i obradjuje ih statisticki. U slucaju</span>
<span class="sd">        da je prosledjen mc to znaci da smo prethodno dodali u onaj</span>
<span class="sd">        choices dictionary odgovarajuc mc, i da sad radimo za njega</span>
<span class="sd">        ako ne prosledjujemo, sve regularno citamo sve, a ne samo</span>
<span class="sd">        mc prvih redova. Ako je prosledjen booli to znaci da su izbaceni</span>
<span class="sd">        ODREDJENI rezultati, pa koristimo taj argument kao indeks koji</span>
<span class="sd">        ce izdvojiti samo zeljenje rezultate</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mc</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">extract_int</span><span class="p">(</span><span class="n">mc</span><span class="p">)</span> <span class="k">if</span> <span class="n">mc</span> <span class="k">else</span> <span class="bp">None</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">try</span><span class="p">:</span>
            
            <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_filename</span><span class="p">(</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">therm</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">util</span><span class="o">.</span><span class="n">show_error</span><span class="p">(</span><span class="s">&#39;Yeah yeah&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Creating mat from file {} for first {} rows&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="n">mc</span><span class="p">))</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_tdfile</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="n">mc</span><span class="p">)</span>
        <span class="n">booli</span> <span class="o">=</span> <span class="n">booli</span> <span class="k">if</span> <span class="n">booli</span> <span class="k">else</span> <span class="p">[</span><span class="bp">True</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">booli</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;matdata booled :</span><span class="se">\n</span><span class="s"> </span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;broj rezultata: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">N</span><span class="p">)</span>
        <span class="n">Eavg</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">E</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">stdE</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">E</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
        <span class="n">stdMeanE</span> <span class="o">=</span> <span class="n">stdE</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">E2</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">E</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">E2avg</span> <span class="o">=</span> <span class="n">E2</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">stdE2</span> <span class="o">=</span> <span class="n">E2</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
        <span class="n">stdMeanE2</span> <span class="o">=</span> <span class="n">stdE2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_magt</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="c">#Ovo mozda da bude unutrasnja funkcija</span>
        <span class="c"># Nem pojma, treba videti sta ti treba</span>
        <span class="c"># gde pa onda da znas</span>
        <span class="n">MAG</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mag_components</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">MAG2</span> <span class="o">=</span> <span class="n">MAG</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">M2</span> <span class="o">=</span> <span class="n">MAG2</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">M1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M2</span><span class="p">)</span>
        <span class="n">M4</span> <span class="o">=</span> <span class="n">M2</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">M2avg</span> <span class="o">=</span> <span class="n">M2</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">M1avg</span> <span class="o">=</span> <span class="n">M1</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">M4avg</span> <span class="o">=</span> <span class="n">M4</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">stdM1</span> <span class="o">=</span> <span class="n">M1</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
        <span class="n">stdM2</span> <span class="o">=</span> <span class="n">M2</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
        <span class="n">stdM4</span> <span class="o">=</span> <span class="n">M4</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
        <span class="n">stdMeanM1</span> <span class="o">=</span> <span class="n">stdM1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">stdMeanM2</span> <span class="o">=</span> <span class="n">stdM2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">stdMeanM4</span> <span class="o">=</span> <span class="n">stdM4</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">val_names</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s">&#39;THERM&#39;</span><span class="p">,</span>
            <span class="s">&#39;Eavg&#39;</span><span class="p">,</span>
            <span class="s">&#39;stdE&#39;</span><span class="p">,</span>
            <span class="s">&#39;stdMeanE&#39;</span><span class="p">,</span>
            <span class="s">&#39;E2avg&#39;</span><span class="p">,</span>
            <span class="s">&#39;stdE2&#39;</span><span class="p">,</span>
            <span class="s">&#39;stdMeanE2&#39;</span><span class="p">,</span>
            <span class="s">&#39;M1avg&#39;</span><span class="p">,</span>
            <span class="s">&#39;stdM1&#39;</span><span class="p">,</span>
            <span class="s">&#39;stdMeanM1&#39;</span><span class="p">,</span>
            <span class="s">&#39;M2avg&#39;</span><span class="p">,</span>
            <span class="s">&#39;stdM2&#39;</span><span class="p">,</span>
            <span class="s">&#39;stdMeanM2&#39;</span><span class="p">,</span>
            <span class="s">&#39;M4avg&#39;</span><span class="p">,</span>
            <span class="s">&#39;stdM4&#39;</span><span class="p">,</span>
            <span class="s">&#39;stdMeanM4&#39;</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span>
            <span class="n">util</span><span class="o">.</span><span class="n">extract_int</span><span class="p">(</span><span class="n">therm</span><span class="p">),</span>
            <span class="n">Eavg</span><span class="p">,</span>
            <span class="n">stdE</span><span class="p">,</span>
            <span class="n">stdMeanE</span><span class="p">,</span>
            <span class="n">E2avg</span><span class="p">,</span>
            <span class="n">stdE2</span><span class="p">,</span>
            <span class="n">stdMeanE2</span><span class="p">,</span>
            <span class="n">M1avg</span><span class="p">,</span>
            <span class="n">stdM1</span><span class="p">,</span>
            <span class="n">stdMeanM1</span><span class="p">,</span>
            <span class="n">M2avg</span><span class="p">,</span>
            <span class="n">stdM2</span><span class="p">,</span>
            <span class="n">stdMeanM2</span><span class="p">,</span>
            <span class="n">M4avg</span><span class="p">,</span>
            <span class="n">stdM4</span><span class="p">,</span>
            <span class="n">stdMeanM4</span><span class="p">,</span>
            <span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">val_names</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">values</span>
</div>
    <span class="nd">@logg</span>
<div class="viewcode-block" id="Choices.compose"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.compose">[docs]</a>    <span class="k">def</span> <span class="nf">compose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">mc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Modifikuje odgovarajuce elemente u self.files [sa izracunatim matovima],</span>
<span class="sd">        ako je potrebno, i vraca strukturu pogodnu za plotovanje&quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Composing for dir_:{} l:{} t:{} mc:{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">mc</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Idem kroz {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="n">dir_</span><span class="p">][</span><span class="n">l</span><span class="p">][</span><span class="n">t</span><span class="p">][</span><span class="n">mc</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
        <span class="k">for</span> <span class="n">therm</span><span class="p">,</span><span class="n">mat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="n">dir_</span><span class="p">][</span><span class="n">l</span><span class="p">][</span><span class="n">t</span><span class="p">][</span><span class="n">mc</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c"># ne znam da li ce biti problem sto menjam ovaj dictionary</span>
            <span class="c"># dok iteriram kroz njega???</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Trenutni mat je </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span><span class="n">mat</span><span class="p">)</span>
            <span class="n">therm_int</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">extract_int</span><span class="p">(</span><span class="n">therm</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="n">dir_</span><span class="p">][</span><span class="n">l</span><span class="p">][</span><span class="n">t</span><span class="p">][</span><span class="n">mc</span><span class="p">][</span><span class="n">therm</span><span class="p">]</span> <span class="o">=</span> <span class="n">mat</span> <span class="k">if</span> <span class="n">mat</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="k">else</span> <span class="s">&quot;weird&quot;</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="n">dir_</span><span class="p">][</span><span class="n">l</span><span class="p">][</span><span class="n">t</span><span class="p">][</span><span class="n">mc</span><span class="p">][</span><span class="n">therm</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_mat</span><span class="p">(</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">therm</span><span class="p">,</span><span class="n">mc</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Vec je izracunat mat&quot;</span><span class="p">)</span>
            <span class="n">data</span><span class="p">[</span><span class="n">therm_int</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="n">dir_</span><span class="p">][</span><span class="n">l</span><span class="p">][</span><span class="n">t</span><span class="p">][</span><span class="n">mc</span><span class="p">][</span><span class="n">therm</span><span class="p">]</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;abs(cv(E1))&#39;</span><span class="p">:</span><span class="nb">abs</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;stdMeanE&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;Eavg&#39;</span><span class="p">]),</span>
            <span class="s">&#39;cv(E2)&#39;</span><span class="p">:</span><span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;stdMeanE2&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;E2avg&#39;</span><span class="p">],</span>
            <span class="s">&#39;cv(M1)&#39;</span><span class="p">:</span><span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;stdMeanM1&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;M1avg&#39;</span><span class="p">],</span>
            <span class="s">&#39;cv(M2)&#39;</span><span class="p">:</span><span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;stdMeanM2&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;M2avg&#39;</span><span class="p">],</span>
            <span class="s">&#39;cv(M4)&#39;</span><span class="p">:</span><span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;stdMeanM4&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;M4avg&#39;</span><span class="p">]}</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span><span class="n">out</span><span class="o">.</span><span class="n">T</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Vracam za plotovanje : </span><span class="se">\n</span><span class="s"> </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span><span class="n">out</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span>
</div>
<div class="viewcode-block" id="Choices.get_plot_dict"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.get_plot_dict">[docs]</a>    <span class="k">def</span> <span class="nf">get_plot_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Vraca dictionary koji</span>
<span class="sd">        sadrzi podatke o tome sta</span>
<span class="sd">        ce se agregirate, tj. sta ce</span>
<span class="sd">        se plotovati. Moze samo matove,</span>
<span class="sd">        moze samo altove, a moze i trenutno</span>
<span class="sd">        izabrane&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bestmats</span><span class="p">[</span><span class="n">dir_</span><span class="p">]</span>
        </div>
    <span class="nd">@logg</span>
<div class="viewcode-block" id="Choices.agregate"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.agregate">[docs]</a>    <span class="k">def</span> <span class="nf">agregate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="p">,</span><span class="n">alt</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">mat</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="n">plot_data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">for_plotting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_plot_dict</span><span class="p">(</span><span class="n">dir_</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">l</span><span class="p">,</span><span class="n">tdict</span> <span class="ow">in</span> <span class="n">for_plotting</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">agg_mat</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">t</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="n">tdict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">mc</span><span class="p">,</span><span class="n">therm</span> <span class="o">=</span><span class="n">val</span><span class="p">[</span><span class="s">&#39;mc&#39;</span><span class="p">],</span><span class="n">val</span><span class="p">[</span><span class="s">&#39;therm&#39;</span><span class="p">]</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">booli</span> <span class="o">=</span> <span class="n">val</span><span class="p">[</span><span class="s">&#39;booli&#39;</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">booli</span> <span class="o">=</span> <span class="bp">False</span>


                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;checking whether calculated : </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="n">dir_</span><span class="p">][</span><span class="n">l</span><span class="p">][</span><span class="n">t</span><span class="p">][</span><span class="n">mc</span><span class="p">][</span><span class="n">therm</span><span class="p">])</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="n">dir_</span><span class="p">][</span><span class="n">l</span><span class="p">][</span><span class="n">t</span><span class="p">][</span><span class="n">mc</span><span class="p">][</span><span class="n">therm</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="n">dir_</span><span class="p">][</span><span class="n">l</span><span class="p">][</span><span class="n">t</span><span class="p">][</span><span class="n">mc</span><span class="p">][</span><span class="n">therm</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">create_mat</span><span class="p">(</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">therm</span><span class="p">)</span>
                <span class="n">data_mat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="n">dir_</span><span class="p">][</span><span class="n">l</span><span class="p">][</span><span class="n">t</span><span class="p">][</span><span class="n">mc</span><span class="p">][</span><span class="n">therm</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">data_mat</span><span class="p">))</span>
                <span class="n">data_mat</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s">&#39;THERM&#39;</span><span class="p">:</span> <span class="s">&#39;T&#39;</span><span class="p">},</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="n">data_mat</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;T&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
                <span class="n">agg_mat</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">data_mat</span><span class="p">,</span><span class="n">t</span><span class="p">))</span>
            <span class="c">#uvek cemo imati samo jednu kolonu, naravno</span>
            <span class="k">print</span> <span class="n">agg_mat</span>
            <span class="n">agg_mat</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">agg_mat</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">util</span><span class="o">.</span><span class="n">extract_int</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">dat</span><span class="p">,</span><span class="n">keys</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">agg_mat</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">util</span><span class="o">.</span><span class="n">show_error</span><span class="p">(</span><span class="s">&#39;No points&#39;</span><span class="p">,</span><span class="s">&#39;No points selected. Ask developer to disable draw button&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&#39;dat,keys&#39;</span><span class="p">,</span><span class="n">dat</span><span class="p">,</span><span class="n">keys</span>
                <span class="n">agg_mat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">)</span>
                <span class="n">plot_data</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">agg_mat</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;plot data </span><span class="se">\n</span><span class="s">:</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span><span class="n">plot_data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_data</span>
        </div>
    <span class="nd">@logg</span>
<div class="viewcode-block" id="Choices.agg"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.agg">[docs]</a>    <span class="k">def</span> <span class="nf">agg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">agg_mat</span><span class="p">):</span>
        <span class="n">T</span> <span class="o">=</span> <span class="n">agg_mat</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;T&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">10000.0</span>
        <span class="n">susc</span> <span class="o">=</span> <span class="p">(</span><span class="n">agg_mat</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;M2avg&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">agg_mat</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;M1avg&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">T</span>

        <span class="n">Tcap</span> <span class="o">=</span> <span class="p">(</span><span class="n">agg_mat</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;E2avg&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">agg_mat</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;Eavg&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">T</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">U</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">agg_mat</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;M4avg&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">agg_mat</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;M2avg&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">print</span> <span class="s">&#39;KUMULANT&#39;</span><span class="p">,</span> <span class="n">U</span>
        <span class="k">print</span> <span class="s">&#39;AGG_MAT</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">agg_mat</span>
        <span class="n">out_index</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s">&#39;T&#39;</span><span class="p">,</span>
            <span class="s">&#39;M1avg&#39;</span><span class="p">,</span>
            <span class="s">&#39;M2avg&#39;</span><span class="p">,</span>
            <span class="s">&#39;M4avg&#39;</span><span class="p">,</span>
            <span class="s">&#39;susc&#39;</span><span class="p">,</span>
            <span class="s">&#39;Eavg&#39;</span><span class="p">,</span>
            <span class="s">&#39;E2avg&#39;</span><span class="p">,</span>
            <span class="s">&#39;Tcap&#39;</span><span class="p">,</span>
            <span class="s">&#39;U&#39;</span>        
            <span class="p">]</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span>
        <span class="n">T</span><span class="p">,</span>
        <span class="n">agg_mat</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;M1avg&#39;</span><span class="p">],</span>
        <span class="n">agg_mat</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;M2avg&#39;</span><span class="p">],</span>
        <span class="n">agg_mat</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;M4avg&#39;</span><span class="p">],</span>
        <span class="n">susc</span><span class="p">,</span>
        <span class="n">agg_mat</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;Eavg&#39;</span><span class="p">],</span>
        <span class="n">agg_mat</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;E2avg&#39;</span><span class="p">],</span>
        <span class="n">Tcap</span><span class="p">,</span>
        <span class="n">U</span>
        <span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">agg_mat</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">out_index</span><span class="p">)</span>
        <span class="k">print</span> <span class="n">out</span>
        <span class="k">return</span> <span class="n">out</span>
</div>
<div class="viewcode-block" id="Choices.remap_fsystem"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.remap_fsystem">[docs]</a>    <span class="k">def</span> <span class="nf">remap_fsystem</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;BICE PROBLEM SA NOVO GENERISANIM MC-OVIMA!!!&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_model</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notify_observers</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Choices.load_bestmat"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.Choices.load_bestmat">[docs]</a>    <span class="k">def</span> <span class="nf">load_bestmat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Proverava da li postoji u strukturi fajlova</span>
<span class="sd">        odgovarajuci podaci iz bestmat-a, ako nema - brise ih</span>
<span class="sd">        vraca azuran bestmat dict&quot;&quot;&quot;</span>
        <span class="n">bmat</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">load_choices</span><span class="p">(</span><span class="s">&#39;bestmat.dict&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">dir_</span><span class="p">,</span><span class="n">ldict</span> <span class="ow">in</span> <span class="n">bmat</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">dir_</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">del</span> <span class="n">bmat</span><span class="p">[</span><span class="n">dir_</span><span class="p">]</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">l</span><span class="p">,</span><span class="n">tdict</span> <span class="ow">in</span> <span class="n">ldict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">l</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="n">dir_</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">del</span> <span class="n">ldict</span><span class="p">[</span><span class="n">l</span><span class="p">]</span>
                    <span class="k">continue</span>
                <span class="k">for</span> <span class="n">t</span><span class="p">,</span><span class="n">tmc_dict</span> <span class="ow">in</span> <span class="n">tdict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">mc</span> <span class="o">=</span> <span class="n">tmc_dict</span><span class="p">[</span><span class="s">&#39;mc&#39;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">t</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="n">dir_</span><span class="p">][</span><span class="n">l</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">or</span> <span class="n">mc</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="n">dir_</span><span class="p">][</span><span class="n">l</span><span class="p">][</span><span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">or</span> <span class="n">tmc_dict</span><span class="p">[</span><span class="s">&#39;therm&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="n">dir_</span><span class="p">][</span><span class="n">l</span><span class="p">][</span><span class="n">t</span><span class="p">][</span><span class="n">mc</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="k">del</span> <span class="n">tdict</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
                        <span class="k">continue</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">bestmats</span> <span class="o">=</span> <span class="n">bmat</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clean_bmat</span><span class="p">()</span>
</div>
    <span class="k">def</span> <span class="nf">_map_filesystem</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Ide kroz sve direktorijume ( za sada jedan sim dir)</span>
<span class="sd">        u simdir-u i izvlaci l,t,i therm.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">funcs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;sp&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">spify</span><span class="p">,</span><span class="s">&#39;mp&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">unify</span><span class="p">}</span>
        <span class="k">def</span> <span class="nf">check_kind</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Ustvari bih mogla da napravim regex</span>
<span class="sd">            za sva tri i onda po grupi da vracam</span>
<span class="sd">            nesto, al ajde, ovo je jednostavno&quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&#39;sp&#39;</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mp_regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
                <span class="k">return</span> <span class="s">&#39;mp&#39;</span>
                
        <span class="n">filess</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">dirs_</span> <span class="o">=</span> <span class="p">[</span><span class="n">dir_</span> <span class="k">for</span> <span class="n">dir_</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simdir</span><span class="p">)</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simdir</span><span class="p">,</span><span class="n">dir_</span><span class="p">))]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;directories in sim folder: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">dirs_</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">dir_</span> <span class="ow">in</span> <span class="n">dirs_</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simdir</span><span class="p">,</span><span class="n">dir_</span><span class="p">)</span>
            <span class="n">choices</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
            <span class="n">mc_to_all</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Currently mapping directory: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span><span class="n">dir_</span><span class="p">)</span>
            <span class="c"># za svaki folder, kind ce biti drugciji, potencijalno</span>
            <span class="n">kind</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">for</span> <span class="n">lt_dir</span><span class="p">,</span><span class="n">dirs</span><span class="p">,</span><span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
                
                <span class="n">ltmatch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lt_regex</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">lt_dir</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">ltmatch</span><span class="p">:</span>
                    <span class="c">#u slucaju da je folder drugog formata</span>
                    <span class="k">continue</span>
                <span class="n">l</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">ltmatch</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
                <span class="c">#samo gledamo one fajlove koji su nam odgovarajuceg formata</span>
                <span class="n">mp_and_sp_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">mp_regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">f</span><span class="p">)]</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">first_file</span> <span class="o">=</span> <span class="n">mp_and_sp_files</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                    <span class="c">#ne postoji ni jedan sp,mp ili dat ili all</span>
                    <span class="n">util</span><span class="o">.</span><span class="n">show_error</span><span class="p">(</span><span class="s">&#39;Empty LT folder&#39;</span><span class="p">,</span><span class="s">&#39;The folder </span><span class="si">%s</span><span class="s"> is empty&#39;</span> <span class="o">%</span><span class="n">lt_dir</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c">#obradjujemo fajlove</span>
                    <span class="n">kind</span> <span class="o">=</span> <span class="n">check_kind</span><span class="p">(</span><span class="n">first_file</span><span class="p">)</span> <span class="k">if</span> <span class="n">kind</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">kind</span>
                
                    <span class="n">different_kind</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">mp_and_sp_files</span> <span class="k">if</span> <span class="n">check_kind</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">!=</span><span class="n">kind</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">different_kind</span><span class="p">:</span>
                        <span class="c">#znaci ako je bilo koji fajl drugog tipa</span>
                        <span class="c"># izaci ce iz programa</span>
                        <span class="n">util</span><span class="o">.</span><span class="n">show_error</span><span class="p">(</span><span class="s">&#39;Mixed pathsies&#39;</span><span class="p">,</span><span class="s">&quot;&quot;&quot;Please seperate multipaths from singlepaths in</span>
<span class="s">                        </span><span class="se">\n</span><span class="s"> foldeR &#39;</span><span class="si">%s</span><span class="s">&#39;, LT folder &#39;</span><span class="si">%s</span><span class="s">&#39;.</span><span class="se">\n</span><span class="s"> Exiting now, bye!&quot;&quot;&quot;</span> <span class="o">%</span><span class="p">(</span> <span class="n">dir_</span><span class="p">,</span><span class="n">lt_dir</span><span class="p">))</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s">&quot;nautilus </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span><span class="n">lt_dir</span><span class="p">)</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="k">pass</span>
                        <span class="k">raise</span> <span class="ne">BaseException</span>
                    <span class="n">funcs</span><span class="p">[</span><span class="n">kind</span><span class="p">](</span><span class="n">lt_dir</span><span class="p">)</span>

                <span class="c">#ovo radimo kad smo obradili sve</span>
                <span class="n">new_files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simdir</span><span class="p">,</span><span class="n">dir_</span><span class="p">,</span><span class="n">lt_dir</span><span class="p">))</span>
                <span class="n">matched</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">new_files</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">f</span><span class="p">)]</span>
                <span class="n">mct_choices</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">all_</span> <span class="ow">in</span> <span class="n">matched</span><span class="p">:</span>
                    <span class="n">therm</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_regex</span><span class="p">,</span><span class="n">all_</span><span class="p">)</span><span class="o">.</span><span class="n">groupdict</span><span class="p">()[</span><span class="s">&#39;therm&#39;</span><span class="p">]</span>
                    <span class="c">#znaci za svaki therm ce dodavati u prikacenu listu</span>
                    <span class="c"># mc-ove tako sto ce otvarati all fajl i brojati linije</span>
                    <span class="n">mc</span> <span class="o">=</span> <span class="s">&quot;MC{sps}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sps</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">lt_dir</span><span class="p">,</span><span class="n">all_</span><span class="p">))</span><span class="o">.</span><span class="n">readlines</span><span class="p">()))</span>
                    <span class="n">mct_choices</span><span class="p">[</span><span class="n">mc</span><span class="p">][</span><span class="n">therm</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
                <span class="n">choices</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">mct_choices</span>
            <span class="k">if</span> <span class="n">choices</span><span class="p">:</span>
                <span class="n">filess</span><span class="p">[</span><span class="n">dir_</span><span class="p">]</span><span class="o">=</span><span class="n">choices</span>
                
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;mapped fsystem: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">filess</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">filess</span>


</div>
<div class="viewcode-block" id="FileManager"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager">[docs]</a><span class="k">class</span> <span class="nc">FileManager</span><span class="p">(</span><span class="n">mvc_skelet</span><span class="o">.</span><span class="n">Controller</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Ova klasa ce brinuti o postojacim l,t,mc, i therm</span>
<span class="sd">    i takodje o izborima razlicitim, znaci originalnim statickim</span>
<span class="sd">    i dinamickim, i onima sa izbacenim rezultatima.Inicijalizuje se sa</span>
<span class="sd">    postojacim l-ovima, postojacim t-ovima, postojacim mc i thermovima</span>
<span class="sd">    Prosledjivace mu se lt_dict, ali lt_dict nece biti globalna varijabla</span>
<span class="sd">    sada, vec ce se ovde cuvati, samo u drugom obliku</span>

<span class="sd">    &quot;&quot;&quot;</span>
   
    <span class="c"># extr_regex = re.compile(r&#39;(?P&lt;base&gt;L\d+T\d+THERM(?P&lt;therm&gt;\d+))MC(?P&lt;mc&gt;\d+)\.mat$&#39;)</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;morace da bude iniciijalizovan sa napravljenim</span>
<span class="sd">        posto ce se praviti kako se budu pozivali matovi, tako ce ovaj</span>
<span class="sd">        vracati, a mi cemo stavljati u nas lt dict, cemo appendovati na nase</span>
<span class="sd">        tuple&quot;&quot;&quot;</span>
        <span class="c">#  logging.basicConfig(level=logging.DEBUG)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s">&quot;FileManager&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gui</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_components</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">match_stuff</span> <span class="o">=</span><span class="p">{</span><span class="s">&#39;l&#39;</span><span class="p">:{</span><span class="s">&#39;result&#39;</span><span class="p">:[],</span><span class="s">&#39;choice&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span><span class="s">&#39;func&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">l_gen</span><span class="p">},</span>
                           <span class="s">&#39;t&#39;</span><span class="p">:{</span><span class="s">&#39;result&#39;</span><span class="p">:[],</span><span class="s">&#39;choice&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span><span class="s">&#39;func&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">t_gen</span><span class="p">},</span>
                           <span class="s">&#39;mc&#39;</span><span class="p">:{</span><span class="s">&#39;result&#39;</span><span class="p">:[],</span><span class="s">&#39;choice&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span><span class="s">&#39;func&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">mc_gen</span><span class="p">},</span>
                           <span class="s">&#39;therm&#39;</span><span class="p">:{</span><span class="s">&#39;result&#39;</span><span class="p">:[],</span><span class="s">&#39;choice&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span><span class="s">&#39;func&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">therm_gen</span><span class="p">}</span>
        <span class="p">}</span>

<div class="viewcode-block" id="FileManager.model_updated"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.model_updated">[docs]</a>    <span class="k">def</span> <span class="nf">model_updated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">subject</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_gui</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="FileManager.init_gui"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.init_gui">[docs]</a>    <span class="k">def</span> <span class="nf">init_gui</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thermPanel</span><span class="p">,</span><span class="n">aggPanel</span><span class="p">,</span><span class="n">scatterPanel</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Kaci gui, kad napravi sve komponente gui-ja</span>
<span class="sd">        iz TabContainera&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tp</span> <span class="o">=</span> <span class="n">thermPanel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ap</span> <span class="o">=</span> <span class="n">aggPanel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sp</span> <span class="o">=</span> <span class="n">scatterPanel</span>
        </div>
<div class="viewcode-block" id="FileManager.init_model"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.init_model">[docs]</a>    <span class="k">def</span> <span class="nf">init_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">Choices</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="FileManager.init_view"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.init_view">[docs]</a>    <span class="k">def</span> <span class="nf">init_view</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Ne znam da li je ok da imam</span>
<span class="sd">        vise view-a, ili da li je potrebno</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">view</span> <span class="o">=</span> <span class="n">ChoicesConverter</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">controller</span> <span class="o">=</span> <span class="bp">self</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FileManager.set_simdir"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.set_simdir">[docs]</a>    <span class="k">def</span> <span class="nf">set_simdir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">simdir</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Prosledjuje modelu simdir</span>
<span class="sd">        ovo je pre nego sto je aplikacija</span>
<span class="sd">        pocela&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">simdir</span> <span class="o">=</span> <span class="n">simdir</span>
        </div>
<div class="viewcode-block" id="FileManager.application_started"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.application_started">[docs]</a>    <span class="k">def</span> <span class="nf">application_started</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Posto je sve vec napravljeno, mozemo</span>
<span class="sd">        da inicijalizujemo model</span>
<span class="sd">        i da postavljamo vrednosti gui elemenata i to</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">simdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simdir</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">init_model</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tp</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_gui</span><span class="p">()</span>
       
       <span class="c"># self.ap.reader.populateListControls(**{&#39;l&#39;:lch})</span>

</div>
<div class="viewcode-block" id="FileManager.update_gui"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.update_gui">[docs]</a>    <span class="k">def</span> <span class="nf">update_gui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Ako je promenjen model</span>
<span class="sd">        updejtuju se svi elementi gui-ja</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dir_choices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">choices</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tp</span><span class="o">.</span><span class="n">set_choices</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s">&#39;dir_&#39;</span><span class="p">:</span><span class="n">dir_choices</span><span class="p">})</span>
        <span class="c">#ovaj ce gledati iz bestmatdicta kako sta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ap</span><span class="o">.</span><span class="n">set_dir_choices</span><span class="p">(</span><span class="n">dir_choices</span><span class="p">)</span>
        
        <span class="c"># samo ce morati da vidi ako ima, ako nema jbg</span>
        <span class="c"># bice prazno</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ap</span><span class="o">.</span><span class="n">set_mag_choices</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">mags</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_matchooser</span><span class="p">()</span>
        <span class="c">####SCATTER PANEL####</span>


</div>
<div class="viewcode-block" id="FileManager.remap_fsystem"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.remap_fsystem">[docs]</a>    <span class="k">def</span> <span class="nf">remap_fsystem</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">remap_fsystem</span><span class="p">()</span></div>
    <span class="nd">@logg</span>
<div class="viewcode-block" id="FileManager.refresh_matchooser"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.refresh_matchooser">[docs]</a>    <span class="k">def</span> <span class="nf">refresh_matchooser</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_choices</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l_gen</span><span class="p">(</span><span class="o">**</span><span class="n">ch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_gen</span><span class="p">(</span><span class="o">**</span><span class="n">ch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mc_gen</span><span class="p">(</span><span class="o">**</span><span class="n">ch</span><span class="p">)</span>
        <span class="n">lch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">matchooseritems</span><span class="p">(</span><span class="n">dir_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ap_dir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">match_stuff</span><span class="p">[</span><span class="s">&#39;l&#39;</span><span class="p">][</span><span class="s">&#39;result&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">lch</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">populate_matchooser</span><span class="p">()</span>
        
    <span class="c">####  GUI INTERFACE ####</span>
    <span class="c">### Ove metode poziva gui ###</span>
    
    
    <span class="c">######### THERM PANEL #############</span>
                       </div>
<div class="viewcode-block" id="FileManager.add_mc"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.add_mc">[docs]</a>    <span class="k">def</span> <span class="nf">add_mc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mc</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dodaje mc u choices, thermove ce morati da</span>
<span class="sd">        preuzme od prvog suseda koji nije &#39;specijalan&#39;</span>
<span class="sd">        Hm, verovatno je pogresno sto iz modela prikazujem</span>
<span class="sd">        errore. verovatno bi trebalo samo da raisujem errore</span>
<span class="sd">        i to a ovde da ih hvatam. hmm</span>
<span class="sd">         &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_mc</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="n">util</span><span class="o">.</span><span class="n">show_error</span><span class="p">(</span><span class="s">&quot;Simdir error&quot;</span><span class="p">,</span><span class="s">&quot;An empty folder in your simulation directory??&quot;</span><span class="p">)</span>
            </div>
<div class="viewcode-block" id="FileManager.on_l_select_tp"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.on_l_select_tp">[docs]</a>    <span class="k">def</span> <span class="nf">on_l_select_tp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">l</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Kada korisnik selektuje l u thermpanelu,</span>
<span class="sd">        namestaju se odredjeni t&quot;&quot;&quot;</span>
        <span class="n">tch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tp</span><span class="o">.</span><span class="n">set_t_choices</span><span class="p">(</span><span class="n">tch</span><span class="p">)</span>
</div>
    <span class="nd">@logg</span>
<div class="viewcode-block" id="FileManager.tp_on_select"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.tp_on_select">[docs]</a>    <span class="k">def</span> <span class="nf">tp_on_select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;prosledjuju se sve sto je selektovano.</span>
<span class="sd">        gleda koja je prva kontrola koja nije prosledjena</span>
<span class="sd">        i u nju stavlja rezultat. oslanja se na sekv. cmbord&quot;&quot;&quot;</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;therm_count&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">True</span>
        <span class="n">choices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tp</span><span class="o">.</span><span class="n">reset_chkboxes</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">cmb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tp</span><span class="o">.</span><span class="n">cmbord</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Nalazim prvi izbor koji nije prosledjen, trenutni: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span><span class="n">cmb</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">dir_</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;dir_&#39;</span><span class="p">]</span>
                <span class="n">l</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;l&#39;</span><span class="p">]</span>
                <span class="n">t</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">uplimit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">get_maxmc</span><span class="p">(</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tp</span><span class="o">.</span><span class="n">set_mc_range</span><span class="p">(</span><span class="n">uplimit</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cmb</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Ovaj nije: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span><span class="n">cmb</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tp</span><span class="o">.</span><span class="n">set_choices</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">cmb</span><span class="p">:</span><span class="n">choices</span><span class="p">})</span>
                <span class="k">return</span>

        <span class="n">util</span><span class="o">.</span><span class="n">show_error</span><span class="p">(</span><span class="s">&#39;What the select?&#39;</span><span class="p">,</span><span class="s">&#39;You selected </span><span class="si">%s</span><span class="s">, what</span><span class="se">\&#39;</span><span class="s">s that?&#39;</span> <span class="o">%</span><span class="n">kwargs</span><span class="p">)</span>
        

      
      


    </div>
<div class="viewcode-block" id="FileManager.get_plot_data"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.get_plot_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_plot_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">mc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Vraca datafrejm za plotovanje&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">mc</span><span class="p">)</span>
    
        

    <span class="c">########################################</span>
    <span class="c">########### AGGREGATE PANEL ############</span>
</div>
<div class="viewcode-block" id="FileManager.get_agg_plot_data"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.get_agg_plot_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_agg_plot_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">agregate</span><span class="p">(</span><span class="n">dir_</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FileManager.annotate_agg"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.annotate_agg">[docs]</a>    <span class="k">def</span> <span class="nf">annotate_agg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Vraca anotaciju za odredjeno l i t</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">annotate_agg</span><span class="p">(</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
</div>
    <span class="nd">@logg</span>
<div class="viewcode-block" id="FileManager.ap_dir_selected"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.ap_dir_selected">[docs]</a>    <span class="k">def</span> <span class="nf">ap_dir_selected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">changed</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ap</span><span class="o">.</span><span class="n">set_l_choices</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">bmat_choices</span><span class="p">(</span><span class="n">dir_</span><span class="o">=</span><span class="n">val</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ap_dir</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">if</span> <span class="n">changed</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">l_gen</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">refresh_matchooser</span><span class="p">()</span>
    

        

    <span class="c">########################################</span>
    <span class="c">######## READER INTERFACE ##############</span>
</div>
<div class="viewcode-block" id="FileManager.set_matchooser_lists"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.set_matchooser_lists">[docs]</a>    <span class="k">def</span> <span class="nf">set_matchooser_lists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">listctrl_names</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;CUva reference na listcontrols&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

           </div>
<div class="viewcode-block" id="FileManager.listctrl_selected"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.listctrl_selected">[docs]</a>    <span class="k">def</span> <span class="nf">listctrl_selected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">choice</span><span class="p">):</span>
        <span class="n">typ</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">extract_name</span><span class="p">(</span><span class="n">choice</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;listctrl selected name:{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">typ</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">match_stuff</span><span class="p">[</span><span class="n">typ</span><span class="p">][</span><span class="s">&#39;func&#39;</span><span class="p">](</span><span class="o">**</span><span class="p">{</span><span class="n">typ</span><span class="p">:</span><span class="n">choice</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">typ</span><span class="o">!=</span><span class="s">&#39;therm&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populate_matchooser</span><span class="p">(</span><span class="n">choice</span> <span class="o">=</span> <span class="n">choice</span><span class="p">)</span>
</div>
    <span class="nd">@logg</span>
<div class="viewcode-block" id="FileManager.populate_matchooser"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.populate_matchooser">[docs]</a>    <span class="k">def</span> <span class="nf">populate_matchooser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">choice</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;populating matchooser, choice made: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span><span class="n">choice</span><span class="p">)</span>
        <span class="n">lala</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;l&#39;</span><span class="p">,</span><span class="s">&#39;t&#39;</span><span class="p">,</span><span class="s">&#39;mc&#39;</span><span class="p">,</span><span class="s">&#39;therm&#39;</span><span class="p">]</span>
        <span class="n">cmpr</span> <span class="o">=</span> <span class="n">lala</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">extract_name</span><span class="p">(</span><span class="n">choice</span><span class="p">))</span> <span class="k">if</span> <span class="n">choice</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">pop</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">match_stuff</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s">&#39;result&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">match_stuff</span> <span class="k">if</span> <span class="n">cmpr</span> <span class="o">&lt;</span> <span class="n">lala</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">key</span><span class="p">)}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;population : {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pop</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ap</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">populateListControls</span><span class="p">(</span><span class="o">**</span><span class="n">pop</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FileManager.add_bestmat"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.add_bestmat">[docs]</a>    <span class="k">def</span> <span class="nf">add_bestmat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">bestm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_choices</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_bestmat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ap_dir</span><span class="p">,</span><span class="o">**</span><span class="n">bestm</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FileManager.random_bestmats"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.random_bestmats">[docs]</a>    <span class="k">def</span> <span class="nf">random_bestmats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="p">):</span>
        <span class="n">bestm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_choices</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">random_bestmats</span><span class="p">(</span><span class="n">dir_</span><span class="p">,</span><span class="o">**</span><span class="n">bestm</span><span class="p">)</span>
                
            
</div>
<div class="viewcode-block" id="FileManager.remove_bestmat"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.remove_bestmat">[docs]</a>    <span class="k">def</span> <span class="nf">remove_bestmat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">typ</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">match_stuff</span><span class="p">[</span><span class="n">typ</span><span class="p">][</span><span class="s">&#39;choice&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span>
        <span class="n">ch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_choices</span><span class="p">()</span>
        <span class="n">ch</span><span class="p">[</span><span class="s">&#39;dir_&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ap_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">remove_bestmat</span><span class="p">(</span><span class="o">**</span><span class="n">ch</span><span class="p">)</span>
        
</div>
<div class="viewcode-block" id="FileManager.current_choices"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.current_choices">[docs]</a>    <span class="k">def</span> <span class="nf">current_choices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Vraca trenutno selektovan izbor</span>
<span class="sd">        u bestmat chooseru &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">match_stuff</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s">&#39;choice&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">match_stuff</span><span class="p">}</span>
</div>
    <span class="nd">@logg</span>
<div class="viewcode-block" id="FileManager.l_gen"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.l_gen">[docs]</a>    <span class="k">def</span> <span class="nf">l_gen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;L izbor prima za parametar</span>
<span class="sd">        stavlja ga medju atribut choices,</span>
<span class="sd">        generise sve izbore za taj i stavlja</span>
<span class="sd">        i zove sve ostale funkcije za atribute</span>
<span class="sd">        zato sto jbg, ne znam kako drugcije</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dir_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ap_dir</span>
        <span class="n">lch</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;l&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s">&#39;l&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">else</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">match_stuff</span><span class="p">[</span><span class="s">&#39;l&#39;</span><span class="p">][</span><span class="s">&#39;choice&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lch</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">match_stuff</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][</span><span class="s">&#39;result&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">matchooseritems</span><span class="p">(</span><span class="n">dir_</span><span class="o">=</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="o">=</span><span class="n">lch</span><span class="p">)</span> <span class="k">if</span> <span class="n">lch</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_gen</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FileManager.t_gen"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.t_gen">[docs]</a>    <span class="k">def</span> <span class="nf">t_gen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">tch</span> <span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s">&#39;t&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">else</span> <span class="bp">None</span>
        <span class="n">lch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">match_stuff</span><span class="p">[</span><span class="s">&#39;l&#39;</span><span class="p">][</span><span class="s">&#39;choice&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;generating mc results for choice </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span><span class="n">tch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">match_stuff</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][</span><span class="s">&#39;choice&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tch</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">match_stuff</span><span class="p">[</span><span class="s">&#39;mc&#39;</span><span class="p">][</span><span class="s">&#39;result&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">matchooseritems</span><span class="p">(</span><span class="n">dir_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ap_dir</span><span class="p">,</span><span class="n">l</span><span class="o">=</span><span class="n">lch</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="n">tch</span><span class="p">)</span> <span class="k">if</span> <span class="n">tch</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mc_gen</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FileManager.mc_gen"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.mc_gen">[docs]</a>    <span class="k">def</span> <span class="nf">mc_gen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">mch</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;mc&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s">&#39;mc&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">else</span> <span class="bp">None</span>
        <span class="n">lch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">match_stuff</span><span class="p">[</span><span class="s">&#39;l&#39;</span><span class="p">][</span><span class="s">&#39;choice&#39;</span><span class="p">]</span>
        <span class="n">tch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">match_stuff</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">][</span><span class="s">&#39;choice&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;generating therm results for choice </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span><span class="n">mch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">match_stuff</span><span class="p">[</span><span class="s">&#39;mc&#39;</span><span class="p">][</span><span class="s">&#39;choice&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mch</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">match_stuff</span><span class="p">[</span><span class="s">&#39;therm&#39;</span><span class="p">][</span><span class="s">&#39;result&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">matchooseritems</span><span class="p">(</span><span class="n">dir_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ap_dir</span><span class="p">,</span><span class="n">l</span> <span class="o">=</span> <span class="n">lch</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="n">tch</span><span class="p">,</span><span class="n">mc</span> <span class="o">=</span> <span class="n">mch</span><span class="p">)</span> <span class="k">if</span> <span class="n">mch</span> <span class="k">else</span> <span class="p">[]</span>
                                    </div>
<div class="viewcode-block" id="FileManager.therm_gen"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.therm_gen">[docs]</a>    <span class="k">def</span> <span class="nf">therm_gen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">match_stuff</span><span class="p">[</span><span class="s">&#39;therm&#39;</span><span class="p">][</span><span class="s">&#39;choice&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;therm&#39;</span><span class="p">]</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">add_bestmat</span><span class="p">()</span>

    
    <span class="c">#############SCATTER PANEL###################</span>
</div>
<div class="viewcode-block" id="FileManager.init_scatter"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.init_scatter">[docs]</a>    <span class="k">def</span> <span class="nf">init_scatter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">bmat_ch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">bmat_choices</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="o">.</span><span class="n">set_dir_choices</span><span class="p">(</span><span class="n">bmat_ch</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FileManager.sp_on_dir_select"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.sp_on_dir_select">[docs]</a>    <span class="k">def</span> <span class="nf">sp_on_dir_select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="n">lch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">bmat_choices</span><span class="p">(</span><span class="n">dir_</span><span class="o">=</span><span class="n">val</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sp</span><span class="o">.</span><span class="n">set_l_choices</span><span class="p">(</span><span class="n">lch</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FileManager.load_sp_data"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.load_sp_data">[docs]</a>    <span class="k">def</span> <span class="nf">load_sp_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">load_sp_data</span><span class="p">(</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FileManager.get_maxmc"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.get_maxmc">[docs]</a>    <span class="k">def</span> <span class="nf">get_maxmc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">get_maxmc</span><span class="p">(</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FileManager.get_scat_title"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.get_scat_title">[docs]</a>    <span class="k">def</span> <span class="nf">get_scat_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;Getting scat title for dir_:{} l:{} t:{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">get_scat_title</span><span class="p">(</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FileManager.calculate_magt"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.calculate_magt">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_magt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">calculate_magt</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FileManager.mag_components"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.mag_components">[docs]</a>    <span class="k">def</span> <span class="nf">mag_components</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mag_components</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FileManager.remove_faulty"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.FileManager.remove_faulty">[docs]</a>    <span class="k">def</span> <span class="nf">remove_faulty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">booli</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Za odredjeno l i t izracunava novi</span>
<span class="sd">        mat, i stavlja ovaj izbor u sve moguce izbore</span>
<span class="sd">        i stavlja taj izbor u izbor za bestmat, sto je</span>
<span class="sd">        problem je l&#39; posto ne postoji na disku teh teh</span>
<span class="sd">        a kako bi se cuvalo, cuvalo bi se nekako brate</span>
<span class="sd">        znaci samo taj booli treba da sacuvamo ali jbg</span>
<span class="sd">        kad nije uniformno sa bestmatom mozda u taj dict</span>
<span class="sd">        da ubacimo samo jos jedno polje hmmm hmmm i da ga</span>
<span class="sd">        tako cuvamo. samo kad bi se to onda racunalo mmm</span>
<span class="sd">        i kako bi se ucitalo pri pokretanju. moralo bi. ajd</span>
<span class="sd">        za sada nek se lepo racuna i dodaje tamo gde treba</span>
<span class="sd">        a posle cemo videti&quot;&quot;&quot;</span>
        <span class="n">mc</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">booli</span><span class="p">)</span>
        <span class="n">prev_mc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">booli</span><span class="p">)</span>
        <span class="n">mc</span> <span class="o">=</span> <span class="s">&#39;MC</span><span class="si">%s</span><span class="s">[</span><span class="si">%s</span><span class="s">]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mc</span><span class="p">,</span><span class="n">prev_mc</span><span class="p">)</span>
        <span class="n">therm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">bestmat_choices</span><span class="p">(</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">which</span><span class="o">=</span><span class="s">&#39;therm&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">add_virtual_file</span><span class="p">(</span><span class="n">dir_</span><span class="o">=</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="o">=</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span><span class="n">mc</span><span class="o">=</span><span class="n">mc</span><span class="p">,</span><span class="n">therm</span><span class="o">=</span><span class="n">therm</span><span class="p">,</span><span class="n">booli</span><span class="o">=</span><span class="n">booli</span><span class="p">)</span>

    
</div></div>
<div class="viewcode-block" id="ChoicesConverter"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.ChoicesConverter">[docs]</a><span class="k">class</span> <span class="nc">ChoicesConverter</span><span class="p">(</span><span class="n">mvc_skelet</span><span class="o">.</span><span class="n">View</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Ova klasa sprema za prikaz</span>
<span class="sd">    za gui izbore inace i u matchooseru&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">controller</span><span class="p">):</span>
        <span class="n">mvc_skelet</span><span class="o">.</span><span class="n">View</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">controller</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s">&quot;ChoicesConverter&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="ChoicesConverter.choices"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.ChoicesConverter.choices">[docs]</a>    <span class="k">def</span> <span class="nf">choices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">l</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">mc</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">therm_count</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="n">reverse</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">t</span> <span class="k">else</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="n">t</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">mc</span> <span class="ow">and</span> <span class="n">therm_count</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mc_choices</span><span class="p">(</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">dir_</span><span class="o">=</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="o">=</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span><span class="n">mc</span><span class="o">=</span><span class="n">mc</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">util</span><span class="o">.</span><span class="n">extract_int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">,</span><span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ChoicesConverter.get_scat_title"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.ChoicesConverter.get_scat_title">[docs]</a>    <span class="k">def</span> <span class="nf">get_scat_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
       
        <span class="n">therm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">bestmat_choices</span><span class="p">(</span><span class="n">dir_</span><span class="o">=</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="o">=</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span><span class="n">which</span><span class="o">=</span><span class="s">&#39;therm&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">print</span> <span class="n">therm</span>
        <span class="n">therm</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">extract_int</span><span class="p">(</span><span class="n">therm</span><span class="p">)</span>
        <span class="n">mc</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">extract_int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">bestmat_choices</span><span class="p">(</span><span class="n">dir_</span><span class="o">=</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="o">=</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span><span class="n">which</span><span class="o">=</span><span class="s">&#39;mc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="s">&quot;T={:.4f}</span><span class="se">\n</span><span class="s">LS={}</span><span class="se">\n</span><span class="s"> SP={}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">extract_int</span><span class="p">(</span><span class="n">t</span><span class="p">))</span><span class="o">/</span><span class="mf">10000.0</span><span class="p">,</span><span class="n">therm</span><span class="p">,</span><span class="n">mc</span><span class="p">)</span>
</div>
    <span class="nd">@counter</span>
    <span class="nd">@benchmark</span>
    <span class="nd">@logg</span>
<div class="viewcode-block" id="ChoicesConverter.matchooseritems"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.ChoicesConverter.matchooseritems">[docs]</a>    <span class="k">def</span> <span class="nf">matchooseritems</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">mc</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="c"># ako je prosledjen mc onda zelimo therm</span>
        <span class="n">which</span> <span class="o">=</span> <span class="s">&#39;therm&#39;</span> <span class="k">if</span> <span class="n">mc</span> <span class="k">else</span> <span class="s">&#39;mc&#39;</span>
        <span class="n">bestmat_ch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">bestmat_choices</span><span class="p">(</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">which</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;bestmatch </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span><span class="n">bestmat_ch</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">mc</span><span class="p">):</span>
            <span class="n">fdict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;pointSize&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="s">&#39;family&#39;</span><span class="p">:</span><span class="n">wx</span><span class="o">.</span><span class="n">FONTFAMILY_DEFAULT</span><span class="p">,</span>
                     <span class="s">&#39;style&#39;</span><span class="p">:</span><span class="n">wx</span><span class="o">.</span><span class="n">FONTSTYLE_NORMAL</span><span class="p">,</span><span class="s">&#39;weight&#39;</span><span class="p">:</span><span class="n">wx</span><span class="o">.</span><span class="n">FONTWEIGHT_NORMAL</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;uredjujem izgleda za :</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span><span class="n">x</span><span class="p">)</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ListItem</span><span class="p">()</span>
            <span class="n">item</span><span class="o">.</span><span class="n">SetText</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bestmat_ch</span> <span class="ow">and</span> <span class="p">(</span><span class="n">mc</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">mc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">bestmat_choices</span><span class="p">(</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="s">&#39;mc&#39;</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&#39;boldovao&#39;</span><span class="p">)</span>
                <span class="n">fdict</span><span class="p">[</span><span class="s">&#39;weight&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">FONTWEIGHT_BOLD</span>
            
            <span class="n">font</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="o">**</span><span class="n">fdict</span><span class="p">)</span>
            <span class="c"># if x in self.model.altmat_choices():</span>
            <span class="c">#     font.SetWeight(wx.FONTWEIGHT_BOLD)</span>
            <span class="n">item</span><span class="o">.</span><span class="n">SetFont</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>
            <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">items</span>
</div>
<div class="viewcode-block" id="ChoicesConverter.bmat_choices"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.ChoicesConverter.bmat_choices">[docs]</a>    <span class="k">def</span> <span class="nf">bmat_choices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">l</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">which</span> <span class="o">=</span> <span class="s">&#39;mc&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">bestmat_choices</span><span class="p">(</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">which</span><span class="p">),</span><span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">util</span><span class="o">.</span><span class="n">extract_int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        </div>
    <span class="k">def</span> <span class="nf">_l_choices_agg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">bestmat_ls</span><span class="p">(),</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">util</span><span class="o">.</span><span class="n">extract_int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="ChoicesConverter.mags"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.ChoicesConverter.mags">[docs]</a>    <span class="k">def</span> <span class="nf">mags</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mags</span>
</div>
<div class="viewcode-block" id="ChoicesConverter.mc_choices"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.ChoicesConverter.mc_choices">[docs]</a>    <span class="k">def</span> <span class="nf">mc_choices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Vraca sve raspolozive mc-ove, formatirane za prikaz. Oni ujedno i odredjuju moguce</span>
<span class="sd">        plotove za therm panel. Ovo podize pitanje da li je bolje da</span>
<span class="sd">        se gleda za koje mc-ove postoje koji thermovi, i obrnuto&quot;&quot;&quot;</span>
        <span class="n">mc_choices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">dir_</span><span class="o">=</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="o">=</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
        
        <span class="n">sorted_mcs</span> <span class="o">=</span>  <span class="nb">sorted</span><span class="p">(</span><span class="n">mc_choices</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">util</span><span class="o">.</span><span class="n">extract_int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">[</span><span class="s">&quot;{mc} ({tmc})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mc</span><span class="o">=</span><span class="n">mc</span><span class="p">,</span><span class="n">tmc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">therm_count</span><span class="p">(</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">mc</span><span class="p">))</span> <span class="k">for</span> <span class="n">mc</span> <span class="ow">in</span> <span class="n">sorted_mcs</span> <span class="p">]</span>

</div>
<div class="viewcode-block" id="ChoicesConverter.annotate_agg"><a class="viewcode-back" href="../../src.mvc.html#src.mvc.ChoicesConverter.annotate_agg">[docs]</a>    <span class="k">def</span> <span class="nf">annotate_agg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
        <span class="n">ls</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">bestmat_choices</span><span class="p">(</span><span class="n">dir_</span><span class="o">=</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="o">=</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span><span class="n">which</span><span class="o">=</span><span class="s">&#39;therm&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">sp</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">bestmat_choices</span><span class="p">(</span><span class="n">dir_</span><span class="o">=</span><span class="n">dir_</span><span class="p">,</span><span class="n">l</span><span class="o">=</span><span class="n">l</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span><span class="n">which</span><span class="o">=</span><span class="s">&#39;mc&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="s">&#39;LS={}</span><span class="se">\n</span><span class="s">SP={}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">extract_int</span><span class="p">(</span><span class="n">ls</span><span class="p">),</span><span class="n">util</span><span class="o">.</span><span class="n">extract_int</span><span class="p">(</span><span class="n">sp</span><span class="p">))</span>

   
</pre></div></div></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">src  documentation</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Author.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b3.
    </div>
  </body>
</html>